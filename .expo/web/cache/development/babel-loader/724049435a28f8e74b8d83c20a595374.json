{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\LogIn\\\\screens\\\\Tracker.jsx\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { CountdownCircleTimer } from 'react-native-countdown-circle-timer';\nimport Constants from 'expo-constants';\nimport axios from 'axios';\nimport { LogBox } from \"react-native-web/dist/index\";\nLogBox.ignoreLogs(['Non-serializable values were found in the navigation state', 'Require cycles are allowed, but can result in uninitialized values. Consider refactoring to remove the need for a cycle.']);\n\nvar Tracker = function Tracker(_ref) {\n  var route = _ref.route,\n      navigation = _ref.navigation;\n  var chck = false;\n  var ride = false;\n  var finished = false;\n\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      isPlaying = _useState2[0],\n      setIsPlaying = _useState2[1];\n\n  var _useState3 = useState(route.params.start),\n      _useState4 = _slicedToArray(_useState3, 2),\n      time = _useState4[0],\n      setTime = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      arrived = _useState6[0],\n      setArrived = _useState6[1];\n\n  var repair_id = route.params.data;\n  var worker_id = route.params.worker_id;\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      wname = _useState8[0],\n      setWname = _useState8[1];\n\n  var getname = function getname() {\n    return _regeneratorRuntime.async(function getname$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(axios.post('https://enigmatic-mesa-42065.herokuapp.com/worker/info', {\n              worker_id: worker_id\n            }).then(function (res) {\n              setWname(res.data.first_name);\n            }).catch(function (err) {\n              console.log(err);\n            }));\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleArrived = function handleArrived() {\n    return _regeneratorRuntime.async(function handleArrived$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(axios.post('https://enigmatic-mesa-42065.herokuapp.com/user/status', {\n              repair_id: repair_id\n            }).then(function (res) {\n              if (res.data.status == \"Repair Started\") {\n                navigation.navigate(\"Inprogress\", {\n                  repair_id: repair_id\n                });\n              }\n            }).catch(function (err) {\n              console.log(err);\n            }));\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    getname();\n    var handle = setInterval(handleArrived, 1000);\n  });\n\n  var handleCancel = function handleCancel() {\n    var seconds;\n    return _regeneratorRuntime.async(function handleCancel$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            endDate = new Date();\n            seconds = (endDate.getTime() - time.getTime()) / 60000;\n\n            if (!(seconds >= 5 && chck == false)) {\n              _context3.next = 7;\n              break;\n            }\n\n            Alert.alert(\"You will be charged as 5 minutes have passed\");\n            chck = true;\n            _context3.next = 9;\n            break;\n\n          case 7:\n            _context3.next = 9;\n            return _regeneratorRuntime.awrap(axios.post('https://enigmatic-mesa-42065.herokuapp.com/user/cancel', {\n              repair_id: repair_id,\n              \"time\": seconds\n            }).then(function (res) {\n              setIsPlaying(false);\n              navigation.navigate('Map');\n            }).catch(function (err) {\n              console.log(err);\n            }));\n\n          case 9:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  function Update(t) {\n    setTime(t);\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }, \"Your Mechanic \", wname, \" is Arrivng Soon\"), React.createElement(CountdownCircleTimer, {\n    isPlaying: isPlaying,\n    duration: 4 * 60,\n    colors: [['#004777', 0.4]],\n    onComplete: function onComplete() {\n      return [false];\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }\n  }, function (_ref2) {\n    var remainingTime = _ref2.remainingTime,\n        animatedColor = _ref2.animatedColor;\n    return React.createElement(View, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }\n    }, React.createElement(Animated.Text, {\n      style: {\n        color: animatedColor,\n        fontSize: 40\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }\n    }, Math.ceil(remainingTime / 60)), React.createElement(Animated.Text, {\n      style: {\n        color: animatedColor,\n        fontSize: 20\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }\n    }, \"Minutes\"));\n  }), React.createElement(Button, {\n    title: \"Cancel\",\n    onPress: handleCancel,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingTop: Constants.statusBarHeight,\n    backgroundColor: '#ecf0f1',\n    padding: 8\n  }\n});\nexport default Tracker;","map":{"version":3,"sources":["D:/LogIn/screens/Tracker.jsx"],"names":["React","useState","useEffect","CountdownCircleTimer","Constants","axios","LogBox","ignoreLogs","Tracker","route","navigation","chck","ride","finished","isPlaying","setIsPlaying","params","start","time","setTime","arrived","setArrived","repair_id","data","worker_id","wname","setWname","getname","post","then","res","first_name","catch","err","console","log","handleArrived","status","navigate","handle","setInterval","handleCancel","endDate","Date","seconds","getTime","Alert","alert","Update","t","styles","container","remainingTime","animatedColor","color","fontSize","Math","ceil","StyleSheet","create","flex","justifyContent","alignItems","paddingTop","statusBarHeight","backgroundColor","padding"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\r\nimport {View, Text,Animated,StyleSheet,Button,Alert} from 'react-native'\r\nimport { CountdownCircleTimer } from 'react-native-countdown-circle-timer'\r\nimport Constants from 'expo-constants';\r\nimport axios from 'axios';\r\nimport { LogBox } from 'react-native';\r\n\r\nLogBox.ignoreLogs([\r\n  'Non-serializable values were found in the navigation state',\r\n  'Require cycles are allowed, but can result in uninitialized values. Consider refactoring to remove the need for a cycle.'\r\n]);\r\n//const repair_id = '6095bf546ce90e1ba0c1124a'\r\nconst Tracker = ({route,navigation}) => {\r\n  var chck = false;\r\n  var ride =  false;\r\n  var finished = false;\r\n  const [isPlaying, setIsPlaying] = useState(true);\r\n  const[time,setTime] = useState(route.params.start);\r\n  const [arrived,setArrived] = useState(false);\r\n  const repair_id = route.params.data;\r\n  const worker_id = route.params.worker_id;\r\n // console.log(worker_id)\r\n  const [wname,setWname] = useState(\"\");\r\n  const getname = async() =>{\r\n    await axios.post('https://enigmatic-mesa-42065.herokuapp.com/worker/info',{worker_id}).then((res) =>{\r\n     setWname(res.data.first_name);\r\n     // console.log(res.data);\r\n    }).catch((err) => {\r\n         console.log(err);\r\n     });\r\n  }\r\n  const handleArrived = async() =>{\r\n   // console.log(\"hello\")\r\n     await axios.post('https://enigmatic-mesa-42065.herokuapp.com/user/status',{repair_id}).then((res) =>{\r\n       if(res.data.status == \"Repair Started\"){\r\n        navigation.navigate(\"Inprogress\",{repair_id:repair_id})}\r\n     }).catch((err) => {\r\n         console.log(err);\r\n     })\r\n   }\r\n  useEffect(() => {\r\n    getname();\r\n    var handle=setInterval(handleArrived,1000);    \r\n  })\r\n\r\n  const handleCancel = async () =>{\r\n    endDate = new Date();\r\n    var seconds = (endDate.getTime() - time.getTime()) / 60000;\r\n    if (seconds >= 5 && chck == false){\r\n      Alert.alert(\"You will be charged as 5 minutes have passed\");\r\n      chck = true;\r\n    }\r\n    else{\r\n    await axios.post('https://enigmatic-mesa-42065.herokuapp.com/user/cancel',{repair_id,\"time\":seconds}).then((res) => {\r\n    setIsPlaying(false);\r\n    navigation.navigate('Map');\r\n  }).catch((err) => {\r\n    console.log(err);\r\n  })}\r\n  }\r\n  function Update(t){\r\n    setTime(t)\r\n}\r\n//handleArrived();\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text>Your Mechanic {wname} is Arrivng Soon</Text>\r\n      <CountdownCircleTimer\r\n        isPlaying={isPlaying}\r\n        duration={4*60}\r\n        colors={[\r\n          ['#004777', 0.4]\r\n        ]}\r\n        onComplete={() => [false]}\r\n    >\r\n      {({ remainingTime, animatedColor }) => (\r\n        <View>\r\n        <Animated.Text style={{ color: animatedColor, fontSize: 40 }}>\r\n          {Math.ceil(remainingTime/60)}\r\n        </Animated.Text>\r\n        <Animated.Text style={{ color: animatedColor, fontSize: 20 }}>\r\n        Minutes</Animated.Text>\r\n        </View>\r\n      )}\r\n    </CountdownCircleTimer>\r\n    <Button title=\"Cancel\" onPress={handleCancel}></Button>\r\n  </View>\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    paddingTop: Constants.statusBarHeight,\r\n    backgroundColor: '#ecf0f1',\r\n    padding: 8,\r\n  }\r\n});\r\n\r\nexport default Tracker;"]},"metadata":{},"sourceType":"module"}